defmodule Usher.Web.Layouts do
  @moduledoc false

  use Usher.Web, :html

  phoenix_js_paths =
    for app <- ~w(phoenix phoenix_html phoenix_live_view)a do
      path = Application.app_dir(app, ["priv", "static", "#{app}.js"])
      Module.put_attribute(__MODULE__, :external_resource, path)
      path
    end

  @static_path Application.app_dir(:usher_web, ["priv", "static"])

  @external_resource css_path = Path.join(@static_path, "app.css")
  @external_resource js_path = Path.join(@static_path, "app.js")

  @css File.read!(css_path)

  @js """
  #{for path <- phoenix_js_paths, do: path |> File.read!() |> String.replace("//# sourceMappingURL=", "// ")}
  #{File.read!(js_path)}
  """

  def render("app.css"), do: @css
  def render("app.js"), do: @js

  embed_templates "layouts/*"

  def logo(assigns) do
    ~H"""
    <svg
      width="32"
      height="32"
      aria-hidden="true"
      viewBox="0 0 1024 1024"
      version="1.1"
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
      xml:space="preserve"
      xmlns:serif="http://www.serif.com/"
      style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;"
    >
      <path
        d="M20.21,392.409c0,0 373.957,-310.192 455.368,-372.913c10.609,-8.174 26.674,-11.799 38.672,-11.178c11.778,0.609 23.889,5.026 33.318,12.42c80.914,63.446 454.958,369.226 454.958,369.226l-481.583,334.721l-500.733,-332.276Z"
        style="fill:#1c98db;stroke:#000;stroke-width:12px;"
      /><path
        d="M90.639,224.427c0.248,-34.825 24.826,-77.82 45.811,-99.361c23.898,-24.529 58.791,-47.447 97.574,-47.817c108.58,-1.035 447.707,0.104 556.287,-0.621c36.896,-0.246 72.883,21.528 96.384,45.954c23.501,24.427 44.349,65.877 44.622,100.603c1.091,139.002 -0,735.891 -0,735.891l-841.273,-0c-0,-0 -0.397,-595.44 0.595,-734.649Z"
        style="fill:#fff;stroke:#000;stroke-width:12px;"
      /><path
        d="M283.542,268.054c-0,11.015 -1.476,20.686 -4.428,29.013c-2.952,8.327 -7.182,15.266 -12.689,20.818c-5.507,5.551 -12.226,9.737 -20.157,12.556c-7.93,2.82 -16.83,4.23 -26.699,4.23c-11.103,-0 -20.62,-1.41 -28.55,-4.23c-7.931,-2.819 -14.363,-6.873 -19.298,-12.16c-4.934,-5.287 -8.503,-11.719 -10.706,-19.297c-2.203,-7.579 -3.304,-16.082 -3.304,-25.51l-0,-114.597l32.515,0l-0,112.614c-0,5.816 0.506,10.971 1.52,15.465c1.013,4.494 2.776,8.305 5.287,11.433c2.511,3.128 5.661,5.485 9.45,7.071c3.789,1.586 8.548,2.379 14.275,2.379c5.376,0 9.914,-0.683 13.614,-2.048c3.701,-1.366 6.786,-3.569 9.253,-6.609c2.467,-3.04 4.318,-6.939 5.551,-11.698c1.234,-4.758 1.851,-10.53 1.851,-17.315l-0,-111.292l32.515,0l-0,109.177Z"
        style="fill-rule:nonzero;"
      /><path
        d="M429.86,279.422c0,9.428 -1.74,17.623 -5.221,24.584c-3.48,6.961 -8.349,12.711 -14.605,17.249c-6.256,4.538 -13.702,7.909 -22.338,10.112c-8.635,2.202 -18.064,3.304 -28.285,3.304c-9.076,-0 -17.844,-0.529 -26.303,-1.586c-8.46,-1.058 -16.831,-2.82 -25.114,-5.287l0,-32.119c4.054,1.41 8.283,2.732 12.689,3.965c4.406,1.234 8.834,2.313 13.284,3.239c4.45,0.925 8.878,1.652 13.284,2.181c4.405,0.528 8.679,0.793 12.821,0.793c6.168,-0 11.411,-0.529 15.728,-1.586c4.318,-1.058 7.843,-2.512 10.575,-4.362c2.731,-1.851 4.714,-4.054 5.947,-6.609c1.234,-2.555 1.851,-5.375 1.851,-8.459c-0,-4.23 -1.212,-7.777 -3.635,-10.64c-2.423,-2.864 -5.617,-5.398 -9.583,-7.601c-3.965,-2.202 -8.481,-4.185 -13.548,-5.947c-5.066,-1.763 -10.221,-3.657 -15.464,-5.684c-5.243,-2.027 -10.398,-4.318 -15.465,-6.873c-5.067,-2.556 -9.583,-5.728 -13.548,-9.517c-3.965,-3.789 -7.159,-8.305 -9.583,-13.548c-2.423,-5.243 -3.634,-11.565 -3.634,-18.967c-0,-6.785 1.233,-13.218 3.701,-19.298c2.467,-6.08 6.344,-11.389 11.631,-15.927c5.287,-4.538 12.072,-8.151 20.355,-10.838c8.283,-2.688 18.284,-4.032 30.004,-4.032c3.437,0 7.027,0.155 10.772,0.463c3.745,0.308 7.446,0.705 11.103,1.19c3.657,0.484 7.182,1.057 10.574,1.718c3.393,0.661 6.499,1.344 9.318,2.049l0,29.739c-2.819,-1.057 -5.903,-2.027 -9.252,-2.908c-3.348,-0.881 -6.807,-1.652 -10.376,-2.313c-3.568,-0.661 -7.159,-1.167 -10.772,-1.52c-3.613,-0.352 -7.049,-0.529 -10.31,-0.529c-5.727,0 -10.574,0.463 -14.539,1.388c-3.965,0.926 -7.226,2.203 -9.781,3.833c-2.555,1.631 -4.406,3.635 -5.551,6.014c-1.146,2.38 -1.719,5.023 -1.719,7.931c0,3.613 1.212,6.719 3.635,9.318c2.423,2.6 5.64,4.935 9.649,7.006c4.009,2.07 8.547,4.009 13.614,5.815c5.067,1.807 10.266,3.745 15.597,5.816c5.331,2.071 10.53,4.428 15.597,7.072c5.066,2.643 9.604,5.859 13.614,9.648c4.009,3.789 7.225,8.261 9.649,13.416c2.423,5.155 3.634,11.257 3.634,18.307Z"
        style="fill-rule:nonzero;"
      /><path
        d="M547.629,331.631l-0,-75.208l-58.686,-0l-0,75.208l-32.515,-0l-0,-172.754l32.515,0l-0,69.393l58.686,-0l-0,-69.393l32.515,0l0,172.754l-32.515,-0Z"
        style="fill-rule:nonzero;"
      /><path
        d="M617.021,331.631l0,-172.754l104.022,0l0,27.493l-70.978,-0l0,42.957l67.674,-0l0,26.832l-67.674,-0l0,47.979l70.978,0l0,27.493l-104.022,-0Z"
        style="fill-rule:nonzero;"
      /><path
        d="M845.685,331.631l-24.32,-55.514c-2.291,-5.287 -5.486,-9.274 -9.583,-11.962c-4.097,-2.687 -8.922,-4.031 -14.473,-4.031l-6.212,-0l-0,71.507l-32.516,-0l0,-172.754l50.359,0c9.517,0 18.152,0.815 25.907,2.446c7.754,1.63 14.363,4.339 19.826,8.128c5.463,3.789 9.671,8.724 12.623,14.804c2.952,6.08 4.428,13.526 4.428,22.338c-0,6.344 -0.925,11.984 -2.776,16.918c-1.85,4.935 -4.45,9.186 -7.798,12.755c-3.349,3.569 -7.336,6.455 -11.962,8.658c-4.626,2.203 -9.671,3.745 -15.134,4.626c4.229,0.881 8.106,3.282 11.631,7.203c3.525,3.922 7.049,9.583 10.574,16.985l27.625,57.893l-38.199,-0Zm-8.063,-121.866c0,-8.459 -2.687,-14.539 -8.062,-18.24c-5.375,-3.701 -13.438,-5.552 -24.188,-5.552l-14.275,0l-0,48.773l13.217,0c5.023,0 9.583,-0.529 13.68,-1.586c4.098,-1.057 7.6,-2.643 10.508,-4.758c2.908,-2.115 5.155,-4.737 6.741,-7.865c1.586,-3.128 2.379,-6.719 2.379,-10.772Z"
        style="fill-rule:nonzero;"
      /><path
        d="M977.129,396.446c6.499,-4.03 16.609,-11.809 21.927,-8.855c7.898,4.388 14.813,16.803 14.96,23.138c2.182,94.082 1.785,445.26 0,542.137c-0.21,11.415 -5.835,26.41 -15.418,36.351c-15.844,16.435 -32.495,24.56 -43.842,20.15c-89.305,-34.708 -475.609,-297.451 -475.609,-297.451c0,-0 411.018,-261.547 497.982,-315.47Z"
        style="fill:#1c98db;stroke:#000;stroke-width:12px;"
      /><path
        d="M59.738,1011.44c-14.378,-0.18 -24.2,-7.024 -35.239,-16.525c-11.039,-9.501 -14.477,-27.489 -14.533,-39.472c-0.432,-91.884 0.172,-449.508 -0.028,-546.135c-0.014,-6.575 7.943,-16.417 13.104,-18.726c5.423,-2.425 13.772,1.505 20.028,5.413c158.379,98.931 774.12,485.783 927.867,588.169c3.536,2.355 2.991,14.112 2.991,14.112c-0,-0 -4.54,11.924 -8.373,12.038c-152.263,4.546 -748.269,3.097 -905.817,1.126Z"
        style="fill:#00b6f2;stroke:#000;stroke-width:12px;"
      />
    </svg>
    """
  end

  def footer(assigns) do
    assigns =
      assign(assigns,
        usher_version: Application.spec(:usher, :vsn),
        usher_web_version: Application.spec(:usher_web, :vsn)
      )

    ~H"""
    <footer class={[
      "flex flex-col px-3 pb-3 text-sm justify-center items-center md:flex-row"
    ]}>
      <.version name="Usher" version={@usher_version} />
      <.version name="Usher.Web" version={@usher_web_version} />
    </footer>
    """
  end

  defp version(assigns) do
    ~H"""
    <span class="text-gray-600 dark:text-gray-400 tabular mr-0 mb-1 md:mr-3 md:mb-0">
      {@name} {if @version, do: "v#{@version}", else: "â€“"}
    </span>
    """
  end
end
